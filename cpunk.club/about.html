<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>About CPUNK</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/about-page.css">
    <link rel="stylesheet" href="css/shared-navigation.css">
    <link rel="stylesheet" href="css/navbar.css">
    <style>
        html, body {
            overflow-x: hidden;
            width: 100%;
            position: relative;
        }
    </style>
</head>
<body>
    <!-- Navbar will be added here by JS -->
    <div class="navbar-placeholder"></div>
    
    <div class="container">
        <!-- Script to load navbar template -->
        <script src="js/translation.js"></script>
        <script src="js/navbar.js"></script>
        <script src="js/sso.js"></script>
        

        <div class="intro-section">
            <p data-i18n="about.intro">Welcome to the world of $CPUNK - Chip-Punk, the first Quantum-Safe MEME Coin in the world, built on the decentralized Cellframe blockchain.</p>
            <p data-i18n="about.mission">We are a community of innovators, enthusiasts, and visionaries who believe in the power of decentralization and the security of the future. $CPUNK is not just a MEME Coin: it's a movement, a celebration of advanced technology, and the strength of community.</p>
        </div>

        <div class="info-grid">
            <div class="info-item">
                <h3>Our Mission <span class="emoji">üöÄ</span></h3>
                <div class="mission-list">
                    <div class="mission-item">
                        <div class="mission-icon">üîç</div>
                        <div class="mission-text">Promote decentralization as a cornerstone of blockchain innovation.</div>
                    </div>
                    <div class="mission-item">
                        <div class="mission-icon">üîÑ</div>
                        <div class="mission-text">Ensure absolute transparency and inclusivity for all our supporters.</div>
                    </div>
                    <div class="mission-item">
                        <div class="mission-icon">üåü</div>
                        <div class="mission-text">Celebrate and empower our community through unique and memorable events.</div>
                    </div>
                </div>
            </div>
            <div class="info-item">
                <h3>Our Values <span class="emoji">üåç</span></h3>
                <div class="values-list">
                    <div class="value-item">
                        <div class="value-label">Transparency</div>
                        <div class="value-desc">Every decision, transaction, and use of funds is open to the community.</div>
                    </div>
                    <div class="value-item">
                        <div class="value-label">Security</div>
                        <div class="value-desc">Thanks to Cellframe's Quantum-Safe technology, the future is protected.</div>
                    </div>
                    <div class="value-item">
                        <div class="value-label">Community</div>
                        <div class="value-desc">Our strength lies in the people who support and drive the project forward.</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="highlight-box">
            <h3>Welcome to the $CPUNK Council! <span class="emoji">üèõÔ∏è</span></h3>
            <p>The $CPUNK Council is a dedicated group of passionate community members who actively shape the future of our project. As we continue to grow, we're looking for more driven individuals to join us in making an impact!</p>

            <h4>Why Join the Council?</h4>
            <div class="event-features">
                <div class="event-feature">
                    <div class="event-icon">üöÄ</div>
                    <div class="event-text">Be Part of the Core Team ‚Äì Collaborate with current council members and gain deeper insights into upcoming developments.</div>
                </div>
                <div class="event-feature">
                    <div class="event-icon">üß™</div>
                    <div class="event-text">Exclusive Beta Testing ‚Äì Be among the first to test new features and provide valuable feedback.</div>
                </div>
                <div class="event-feature">
                    <div class="event-icon">üó≥Ô∏è</div>
                    <div class="event-text">Right to Propose Changes ‚Äì As a council member, you gain the exclusive ability to draft and submit improvement proposals for DAO voting. This empowers you to directly shape the project's direction and drive meaningful changes within the $CPUNK ecosystem.</div>
                </div>
                <div class="event-feature">
                    <div class="event-icon">üîä</div>
                    <div class="event-text">Voice Your Ideas ‚Äì Help shape proposals and actively participate in community votes.</div>
                </div>
                <div class="event-feature">
                    <div class="event-icon">ü§ù</div>
                    <div class="event-text">Collaborate with Visionaries ‚Äì Join a community of committed and like-minded enthusiasts.</div>
                </div>
            </div>

            <h4>Requirements:</h4>
            <div class="event-features">
                <div class="event-feature">
                    <div class="event-icon">üß¨</div>
                    <div class="event-text">Registered DNA ‚Äì Verify your identity within the $CPUNK ecosystem.</div>
                </div>
                <div class="event-feature">
                    <div class="event-icon">üè¶</div>
                    <div class="event-text">10M+ $CPUNK held ‚Äì Demonstrate your commitment to the project by holding a significant stake.</div>
                </div>
                <div class="event-feature">
                    <div class="event-icon">üåü</div>
                    <div class="event-text">Skills & Time ‚Äì We prioritize individuals who can actively contribute to $CPUNK's growth and vision.</div>
                </div>
            </div>

            <h4>Ready to Make a Difference?</h4>
            <p>Join the Council and help shape the future of $CPUNK! Your involvement will have a direct impact on the project's direction and success. ‚ú®</p>
            <div style="text-align: center; margin-top: 20px;">
                <button id="apply-button" class="primary-button">Apply Now</button>
            </div>
        </div>

        <div class="highlight-box">
            <div class="mascot-section">
                <div class="mascot-image">üêøÔ∏è</div>
                <div class="mascot-details">
                    <h3>The Punk Chipmunk: A Symbol of Innovation</h3>
                    <p>Our punk chipmunk with its fiery red mohawk represents who we are: bold, resilient, and revolutionary. It embodies a vision that combines innovation and fun.</p>
                </div>
            </div>
        </div>

    </div>
    
    <!-- Core utilities - loaded on all pages for consistency -->
    <script src="js/cpunk-utils.js"></script>
    <script src="js/cpunk-transaction.js"></script>
    <script src="js/cpunk-ui.js"></script>
    <script src="js/cpunk-api-console.js"></script>
    <script src="js/dashboardConnector.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize the Apply button functionality
            const applyButton = document.getElementById('apply-button');
            if (applyButton) {
                applyButton.addEventListener('click', startCouncilApplication);
            }

            // Function to handle Council application process
            function startCouncilApplication() {
                // Create modal container
                const modalContainer = document.createElement('div');
                modalContainer.className = 'modal-container';
                modalContainer.innerHTML = `
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>Apply for CPUNK Council</h3>
                            <button class="modal-close">&times;</button>
                        </div>
                        <div class="modal-body">
                            <!-- Connection Section -->
                            <div id="connectionSection" class="application-section">
                                <h4>Step 1: Connect to Dashboard</h4>
                                <p>First, connect to your Cellframe Dashboard to verify your wallet.</p>

                                <!-- Dashboard Connection Status (styled like login page) -->
                                <div class="status-box" style="display: flex; justify-content: space-between; align-items: center;">
                                    <div class="status-header" style="margin-bottom: 0;">
                                        <span>Dashboard Status:</span>
                                        <span class="status-indicator status-disconnected" id="statusIndicator">Disconnected</span>
                                    </div>
                                    <div id="connection-button-container">
                                        <button id="connectButton" class="help-button" style="margin: 0; width: auto;">Connect</button>
                                    </div>
                                </div>

                                <div id="connectionError" class="error-message" style="display: none;"></div>
                            </div>

                            <!-- Wallet Selection Section -->
                            <div id="walletSection" class="application-section" style="display: none;">
                                <h4>Step 2: Select Wallet</h4>
                                <p>Select a wallet with at least 10M CPUNK tokens.</p>
                                <div id="walletsList" class="selection-list"></div>
                                <div id="walletError" class="error-message" style="display: none;"></div>
                            </div>

                            <!-- DNA Selection Section -->
                            <div id="dnaSection" class="application-section" style="display: none;">
                                <h4>Step 3: Select DNA</h4>
                                <p>Select your registered DNA to use for Council representation.</p>
                                <div id="dnaList" class="selection-list"></div>
                                <div id="dnaError" class="error-message" style="display: none;"></div>
                            </div>

                            <!-- Verification Result -->
                            <div id="verificationResult" class="application-section" style="display: none;">
                                <div id="verificationSuccess" class="success-message" style="display: none;">
                                    <h4>Verification Successful!</h4>
                                    <p>Your wallet and DNA have been verified. An admin will review your application shortly.</p>
                                    <div id="verificationDetails"></div>
                                </div>
                                <div id="verificationFailed" class="error-message" style="display: none;">
                                    <h4>Verification Failed</h4>
                                    <p>Your wallet does not meet the minimum requirement of 10M CPUNK tokens.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                // Add modal styles
                const modalStyle = document.createElement('style');
                modalStyle.textContent = `
                    .modal-container {
                        position: fixed;
                        top: 0;
                        left: 0;
                        right: 0;
                        bottom: 0;
                        background-color: rgba(0, 0, 0, 0.7);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        z-index: 1000;
                    }
                    .modal-content {
                        background-color: var(--card-bg, #1a1a24);
                        border-radius: 8px;
                        max-width: 600px;
                        width: 90%;
                        max-height: 90vh;
                        overflow-y: auto;
                        box-shadow: 0 5px 30px rgba(0, 0, 0, 0.3);
                    }
                    .modal-header {
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        padding: 15px 20px;
                        border-bottom: 1px solid var(--accent-color, #7640ff);
                    }
                    .modal-header h3 {
                        margin: 0;
                        color: var(--accent-color, #7640ff);
                    }
                    .modal-close {
                        background: none;
                        border: none;
                        font-size: 24px;
                        color: var(--text-color, #ffffff);
                        cursor: pointer;
                    }
                    .modal-body {
                        padding: 20px;
                    }
                    .application-section {
                        margin-bottom: 20px;
                    }
                    .application-section h4 {
                        margin-top: 0;
                        color: var(--text-color, #ffffff);
                    }
                    .status-indicator {
                        display: inline-block;
                        padding: 5px 10px;
                        border-radius: 4px;
                        margin: 10px 0;
                        font-weight: bold;
                    }
                    .status-disconnected {
                        background-color: rgba(255, 68, 68, 0.2);
                        color: #ff4444;
                    }
                    .status-connecting {
                        background-color: rgba(255, 193, 7, 0.2);
                        color: #ffc107;
                    }
                    .status-connected {
                        background-color: rgba(0, 200, 83, 0.2);
                        color: #00c853;
                    }
                    .action-button {
                        background-color: var(--accent-color, #7640ff);
                        color: #ffffff;
                        border: none;
                        border-radius: 4px;
                        padding: 10px 15px;
                        cursor: pointer;
                        margin: 10px 0;
                        font-weight: bold;
                    }
                    .action-button:disabled {
                        opacity: 0.5;
                        cursor: not-allowed;
                    }
                    .error-message {
                        background-color: rgba(255, 68, 68, 0.1);
                        color: #ff4444;
                        padding: 10px;
                        border-radius: 4px;
                        margin: 10px 0;
                    }
                    .success-message {
                        background-color: rgba(0, 200, 83, 0.1);
                        color: #00c853;
                        padding: 10px;
                        border-radius: 4px;
                        margin: 10px 0;
                    }
                    .selection-list {
                        display: grid;
                        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                        gap: 10px;
                        margin: 15px 0;
                    }
                    .wallet-card, .dna-card {
                        background-color: var(--bg-color, #141420);
                        border-radius: 6px;
                        padding: 15px;
                        cursor: pointer;
                        transition: all 0.2s ease;
                        border: 2px solid transparent;
                    }
                    .wallet-card:hover, .dna-card:hover {
                        transform: translateY(-3px);
                        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
                    }
                    .wallet-card.selected, .dna-card.selected {
                        border-color: var(--accent-color, #7640ff);
                        background-color: rgba(118, 64, 255, 0.1);
                    }
                    .wallet-name, .dna-name {
                        font-weight: bold;
                        margin-bottom: 5px;
                    }
                    .wallet-balances {
                        display: flex;
                        flex-direction: column;
                        gap: 5px;
                        font-size: 0.9em;
                        color: var(--muted-color, #a0a0a0);
                    }
                    .completed-step {
                        border-left: 3px solid var(--success-color, #00c853);
                        padding-left: 15px;
                        animation: fadeGreen 0.5s ease-in-out;
                    }
                    .step-checkmark {
                        display: inline-block;
                        margin-left: 10px;
                        color: var(--success-color, #00c853);
                        font-weight: bold;
                        font-size: 1.2em;
                        animation: scaleIn 0.3s ease-in-out;
                    }
                    @keyframes fadeGreen {
                        from { border-color: transparent; }
                        to { border-color: var(--success-color, #00c853); }
                    }
                    @keyframes scaleIn {
                        from { transform: scale(0); opacity: 0; }
                        to { transform: scale(1); opacity: 1; }
                    }
                `;

                // Add the modal and styles to the document
                document.body.appendChild(modalStyle);
                document.body.appendChild(modalContainer);

                // Add event listener to close button
                const closeButton = modalContainer.querySelector('.modal-close');
                closeButton.addEventListener('click', () => {
                    document.body.removeChild(modalContainer);
                    document.body.removeChild(modalStyle);
                });

                // Initialize CpunkDashboard
                CpunkDashboard.init({
                    statusIndicatorId: 'statusIndicator',
                    connectButtonId: 'connectButton',
                    connectionErrorId: 'connectionError',
                    walletSectionId: 'walletSection',
                    walletsListId: 'walletsList',
                    walletErrorId: 'walletError',
                    dnaSectionId: 'dnaSection',
                    dnaListId: 'dnaList',
                    dnaErrorId: 'dnaError',
                    onConnected: async function(sessionId) {
                        console.log('Connected with session:', sessionId);

                        // Hide connect button after successful connection
                        const buttonContainer = document.getElementById('connection-button-container');
                        if (buttonContainer) {
                            buttonContainer.style.display = 'none';
                        }

                        // Mark connection step as completed with checkmark
                        const connectionStep = document.getElementById('connectionSection');
                        if (connectionStep) {
                            connectionStep.classList.add('completed-step');
                            const checkmark = document.createElement('div');
                            checkmark.className = 'step-checkmark';
                            checkmark.innerHTML = '‚úì';
                            connectionStep.querySelector('h4').appendChild(checkmark);
                        }

                        // After connection, load and filter wallets
                        try {
                            const walletsList = document.getElementById('walletsList');
                            walletsList.innerHTML = '<div style="text-align: center; padding: 20px;">Loading wallets...</div>';

                            // Get all wallets
                            const walletsResponse = await CpunkDashboard.makeRequest('GetWallets', { id: sessionId });

                            if (walletsResponse.status !== 'ok' || !Array.isArray(walletsResponse.data)) {
                                throw new Error('Failed to load wallets');
                            }

                            // Clear the wallets list
                            walletsList.innerHTML = '';

                            // Track eligible and ineligible wallets
                            const eligibleWallets = [];
                            const ineligibleWallets = [];

                            // Process each wallet
                            for (const wallet of walletsResponse.data) {
                                // Get detailed wallet data
                                const walletDataResponse = await CpunkDashboard.makeRequest('GetDataWallet', {
                                    id: sessionId,
                                    walletName: wallet.name
                                });

                                if (walletDataResponse.status !== 'ok' || !Array.isArray(walletDataResponse.data)) {
                                    continue;
                                }

                                // Find CPUNK token
                                let cpunkBalance = 0;
                                let walletNetwork = null;
                                let walletAddress = null;

                                // Look through all networks to find CPUNK tokens
                                for (const network of walletDataResponse.data) {
                                    if (network.tokens) {
                                        const cpunkToken = network.tokens.find(token => token.tokenName === 'CPUNK');
                                        if (cpunkToken) {
                                            cpunkBalance = parseFloat(cpunkToken.balance || 0);
                                            walletNetwork = network.network;
                                            walletAddress = network.address;
                                            break;
                                        }
                                    }
                                }

                                // Store wallet with its CPUNK balance
                                const walletInfo = {
                                    name: wallet.name,
                                    balance: cpunkBalance,
                                    network: walletNetwork,
                                    address: walletAddress,
                                    data: walletDataResponse.data
                                };

                                // Check if eligible (has at least 10M CPUNK)
                                if (cpunkBalance >= 10000000) {
                                    eligibleWallets.push(walletInfo);
                                } else {
                                    ineligibleWallets.push(walletInfo);
                                }
                            }

                            // Display eligible wallets or show message
                            if (eligibleWallets.length > 0) {
                                // Add each eligible wallet to the UI
                                eligibleWallets.forEach(wallet => {
                                    const walletCard = document.createElement('div');
                                    walletCard.className = 'wallet-card';
                                    walletCard.innerHTML = `
                                        <div class="wallet-name">${wallet.name}</div>
                                        <div class="wallet-balances">
                                            <div>CPUNK: ${(wallet.balance).toLocaleString()}</div>
                                            <div>Network: ${wallet.network || 'Unknown'}</div>
                                        </div>
                                    `;

                                    walletCard.addEventListener('click', () => {
                                        // Deselect all wallet cards
                                        document.querySelectorAll('.wallet-card').forEach(card => {
                                            card.classList.remove('selected');
                                        });

                                        // Select this wallet card
                                        walletCard.classList.add('selected');

                                        // Handle wallet selection via CpunkDashboard
                                        CpunkDashboard.selectWallet(wallet.name);
                                    });

                                    walletsList.appendChild(walletCard);
                                });
                            } else {
                                // No eligible wallets found
                                let message = '<div style="color: var(--error); background-color: rgba(255, 68, 68, 0.1); padding: 20px; border-radius: 8px; text-align: center; margin-bottom: 20px;">';
                                message += '<p><strong>No eligible wallets found</strong></p>';
                                message += '<p>You need a wallet with at least 10M CPUNK tokens to apply for the Council.</p>';

                                if (ineligibleWallets.length > 0) {
                                    message += '<p>Your wallets:</p>';
                                    message += '<ul style="list-style: none; padding: 0; margin-top: 15px;">';

                                    ineligibleWallets.forEach(wallet => {
                                        message += `
                                            <li style="padding: 12px; margin: 8px 0; border-radius: 6px; background-color: var(--dark-bg, #0f0f18); text-align: left;">
                                                <strong>${wallet.name}</strong>
                                                <div style="margin-top: 5px;">CPUNK: ${(wallet.balance).toLocaleString()} <span style="color: var(--error);">(Need at least 10,000,000)</span></div>
                                            </li>
                                        `;
                                    });

                                    message += '</ul>';
                                }

                                message += '</div>';
                                walletsList.innerHTML = message;
                            }
                        } catch (error) {
                            console.error('Error loading wallets:', error);
                            document.getElementById('walletError').textContent = `Error loading wallets: ${error.message}`;
                            document.getElementById('walletError').style.display = 'block';
                        }
                    },
                    onWalletSelected: function(wallet) {
                        console.log('Selected wallet:', wallet);
                        // All wallets shown at this point should be eligible
                        // We've already filtered them in the onConnected callback

                        // Mark wallet selection step as completed with checkmark
                        const walletSection = document.getElementById('walletSection');
                        if (walletSection) {
                            walletSection.classList.add('completed-step');
                            // Only add checkmark if it doesn't already exist
                            if (!walletSection.querySelector('.step-checkmark')) {
                                const checkmark = document.createElement('div');
                                checkmark.className = 'step-checkmark';
                                checkmark.innerHTML = '‚úì';
                                walletSection.querySelector('h4').appendChild(checkmark);
                            }

                            // Keep wallet section visible, don't hide it
                            walletSection.style.display = 'block';
                        }
                    },
                    onDnaSelected: function(dna) {
                        console.log('Selected DNA:', dna);

                        // Mark DNA selection step as completed with checkmark
                        const dnaSection = document.getElementById('dnaSection');
                        if (dnaSection) {
                            dnaSection.classList.add('completed-step');
                            // Only add checkmark if it doesn't already exist
                            if (!dnaSection.querySelector('.step-checkmark')) {
                                const checkmark = document.createElement('div');
                                checkmark.className = 'step-checkmark';
                                checkmark.innerHTML = '‚úì';
                                dnaSection.querySelector('h4').appendChild(checkmark);
                            }
                        }

                        // Application verified successfully
                        const verificationResult = document.getElementById('verificationResult');
                        verificationResult.style.display = 'block';
                        document.getElementById('verificationSuccess').style.display = 'block';
                        document.getElementById('verificationFailed').style.display = 'none';

                        // Store application data for submission
                        window.councilApplication = {
                            dna: dna.name,
                            wallet: dna.wallet,
                            network: dna.network,
                            timestamp: new Date().toISOString()
                        };

                        // Show verification details with submit button
                        const verificationDetails = document.getElementById('verificationDetails');
                        verificationDetails.innerHTML = `
                            <div style="margin-top: 15px;">
                                <p><strong>DNA:</strong> ${dna.name}</p>
                                <p><strong>Wallet:</strong> ${dna.wallet}</p>
                                <p>Please review your information and click the button below to submit your application.</p>
                                <div style="text-align: center; margin-top: 20px;">
                                    <button id="submitApplicationButton" class="primary-button" style="background-color: var(--primary); color: var(--text); padding: 12px 25px; border-radius: 6px; border: none; font-weight: bold; cursor: pointer;">
                                        Submit Application
                                    </button>
                                </div>
                                <div id="submitMessage" style="margin-top: 15px; display: none;"></div>
                            </div>
                        `;

                        // Add event listener to the submit button
                        setTimeout(() => {
                            const submitBtn = document.getElementById('submitApplicationButton');
                            if (submitBtn) {
                                submitBtn.addEventListener('click', function() {
                                    submitCouncilApplication(dna);
                                });
                            }
                        }, 100);
                    }
                });

                // Function to handle council application submission
                function submitCouncilApplication(dna) {
                    // Get the submit button and disable it during submission
                    const submitBtn = document.getElementById('submitApplicationButton');
                    const submitMessage = document.getElementById('submitMessage');

                    if (submitBtn) {
                        submitBtn.disabled = true;
                        submitBtn.innerHTML = 'Submitting...';
                    }

                    if (submitMessage) {
                        submitMessage.style.display = 'block';
                        submitMessage.innerHTML = '<div style="color: var(--warning); text-align: center;">Submitting your application...</div>';
                    }

                    // Prepare application data
                    const applicationData = {
                        action: 'council_application',
                        dna: dna.name,
                        wallet: dna.wallet,
                        network: dna.network || 'Backbone',
                        timestamp: new Date().toISOString()
                    };

                    // Submit data to the server using save_content.php
                    fetch('save_content.php', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(applicationData)
                    })
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.json();
                    })
                    .then(data => {
                        console.log('Application submitted successfully:', data);

                        // Hide previous steps
                        const connectionSection = document.getElementById('connectionSection');
                        const walletSection = document.getElementById('walletSection');
                        const dnaSection = document.getElementById('dnaSection');

                        if (connectionSection) connectionSection.style.display = 'none';
                        if (walletSection) walletSection.style.display = 'none';
                        if (dnaSection) dnaSection.style.display = 'none';

                        // Show success message
                        if (submitMessage) {
                            submitMessage.innerHTML = '<div style="color: var(--success); background-color: rgba(0, 200, 81, 0.1); padding: 15px; border-radius: 8px; text-align: center; margin-bottom: 20px;"><strong>Success!</strong> Your application has been submitted. Thank you for applying to the CPUNK Council!</div>';
                        }

                        // Hide submit button instead of just disabling it
                        if (submitBtn) {
                            submitBtn.style.display = 'none';
                        }

                        // Add close button only
                        const verificationDetails = document.getElementById('verificationDetails');
                        if (verificationDetails) {
                            const closeButtonContainer = document.createElement('div');
                            closeButtonContainer.style.marginTop = '25px';
                            closeButtonContainer.style.textAlign = 'center';
                            closeButtonContainer.innerHTML =
                                '<button onclick="document.querySelector(\'.modal-close\').click();" style="background-color: var(--dark-bg); color: var(--text); border: 1px solid var(--text-dim); padding: 8px 16px; border-radius: 4px; cursor: pointer;">Close Window</button>';

                            verificationDetails.appendChild(closeButtonContainer);
                        }
                    })
                    .catch(error => {
                        console.error('Error submitting application:', error);

                        // Show error message
                        if (submitMessage) {
                            submitMessage.innerHTML = `<div style="color: var(--error); background-color: rgba(255, 68, 68, 0.1); padding: 15px; border-radius: 8px; text-align: center;"><strong>Error!</strong> There was a problem submitting your application. Please try again later or contact support.</div>`;
                        }

                        // Reset button
                        if (submitBtn) {
                            submitBtn.disabled = false;
                            submitBtn.innerHTML = 'Try Again';
                        }
                    });
                }
            }
        });

        // Initialize SSO
        CpunkSSO.getInstance().init({
            onAuthenticated: (user) => {
                console.log('User authenticated:', user.dna);
            },
            onUnauthenticated: () => {
                console.log('User not authenticated');
            }
        });
    </script>
</body>
</html>
